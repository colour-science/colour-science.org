<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>colour.notation.munsell &mdash; Colour 0.3.5 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootswatch-3.1.0/colour/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/styles.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.3.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Colour 0.3.5 documentation" href="../../../index.html" />
    <link rel="up" title="colour.notation" href="../notation.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html"><img src="../../../_static/Colour_Logo_Icon_001.png">
          Colour&nbsp;0.3</a>
        <!--<span class="navbar-text navbar-version pull-left"><b>0.3</b></span>-->
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
                <li><a href="https://www.colour-science.org">colour-science.org</a></li>
            
              <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-life-ring">&nbsp;Documentation</i><b class="caret"></b></a>
                  <ul class="dropdown-menu">
                      <li>
                          <a href="api.html" class="fa fa-life-ring">&nbsp;API Reference</a>
                      </li>
                      <li>
                          <a href="http://nbviewer.ipython.org/github/colour-science/colour-ipython/blob/master/notebooks/colour.ipynb', True)" class="fa fa-book">&nbsp;IPython Notebooks</a>
                      </li>
                      <li>
                          <a href="https://www.colour-science.org/features.php" class="fa fa-lightbulb-o">&nbsp;Features</a>
                      </li>
                      <li>
                          <a href="https://www.colour-science.org/contributing.php"><span class="fa fa-gears">&nbsp;Contributing</span></a>
                      </li>
                  </ul>
              </li>
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <h1>Source code for colour.notation.munsell</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/env python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Munsell Renotation System</span>
<span class="sd">=========================</span>

<span class="sd">Defines various objects for *Munsell Renotation System* computations:</span>

<span class="sd">-   :func:`munsell_value_Priest1920`: *Munsell* value :math:`V` computation of</span>
<span class="sd">    given *luminance* :math:`Y` using Priest, Gibson and MacNicholas (1920)</span>
<span class="sd">    method.</span>
<span class="sd">-   :func:`munsell_value_Munsell1933`: *Munsell* value :math:`V` computation of</span>
<span class="sd">    given *luminance* :math:`Y` using ⁠Munsell, Sloan and Godlove (1933)⁠</span>
<span class="sd">    method.</span>
<span class="sd">-   :func:`munsell_value_Moon1943`: *Munsell* value :math:`V` computation of</span>
<span class="sd">    given *luminance* :math:`Y` using Moon and Spencer (1943) method.</span>
<span class="sd">-   :func:`munsell_value_Saunderson1944`: *Munsell* value :math:`V` computation</span>
<span class="sd">    of given *luminance* :math:`Y` using Saunderson and Milner (1944) method.</span>
<span class="sd">-   :func:`munsell_value_Ladd1955`: *Munsell* value :math:`V` computation of</span>
<span class="sd">    given *luminance* :math:`Y` using Ladd and Pinney (1955)  method.</span>
<span class="sd">-   :func:`munsell_value_McCamy1987`: *Munsell* value :math:`V` computation of</span>
<span class="sd">    given *luminance* :math:`Y` using McCamy (1987)  method.</span>
<span class="sd">-   :func:`munsell_value_ASTMD153508` [1]_ [2]_: *Munsell* value :math:`V`</span>
<span class="sd">    computation of given *luminance* :math:`Y` using ASTM D1535-08e1 (2008)</span>
<span class="sd">    method.</span>
<span class="sd">-   :func:`munsell_colour_to_xyY` [1]_ [2]_</span>
<span class="sd">-   :func:`xyY_to_munsell_colour` [1]_ [2]_</span>

<span class="sd">See Also</span>
<span class="sd">--------</span>
<span class="sd">`Munsell Renotation System IPython Notebook</span>
<span class="sd">&lt;http://nbviewer.ipython.org/github/colour-science/colour-ipython/blob/master/notebooks/notation/munsell.ipynb&gt;`_  # noqa</span>

<span class="sd">References</span>
<span class="sd">----------</span>
<span class="sd">.. [1]  Centore, P. (n.d.). Munsell Resources. Retrieved July 26, 2014, from</span>
<span class="sd">        http://www.99main.com/~centore/MunsellResources/MunsellResources.html</span>
<span class="sd">.. [2]  Centore, P. (2012). An open-source inversion algorithm for the Munsell</span>
<span class="sd">        renotation. Color Research &amp; Application, 37(6), 455–464.</span>
<span class="sd">        doi:10.1002/col.20715</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">unicode_literals</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">ordereddict</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="kn">from</span> <span class="nn">colour.algebra</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Extrapolator1d</span><span class="p">,</span>
    <span class="n">LinearInterpolator1d</span><span class="p">,</span>
    <span class="n">cartesian_to_cylindrical</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">colour.colorimetry</span> <span class="kn">import</span> <span class="n">ILLUMINANTS</span><span class="p">,</span> <span class="n">luminance_ASTMD153508</span>
<span class="kn">from</span> <span class="nn">colour.constants</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">INTEGER_THRESHOLD</span><span class="p">,</span>
    <span class="n">FLOATING_POINT_NUMBER_PATTERN</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">colour.models</span> <span class="kn">import</span> <span class="n">Lab_to_LCHab</span><span class="p">,</span> <span class="n">XYZ_to_Lab</span><span class="p">,</span> <span class="n">XYZ_to_xy</span><span class="p">,</span> <span class="n">xyY_to_XYZ</span>
<span class="kn">from</span> <span class="nn">colour.volume</span> <span class="kn">import</span> <span class="n">is_within_macadam_limits</span>
<span class="kn">from</span> <span class="nn">colour.notation</span> <span class="kn">import</span> <span class="n">MUNSELL_COLOURS_ALL</span>
<span class="kn">from</span> <span class="nn">colour.utilities</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CaseInsensitiveMapping</span><span class="p">,</span>
    <span class="n">Lookup</span><span class="p">,</span>
    <span class="n">is_integer</span><span class="p">,</span>
    <span class="n">is_numeric</span><span class="p">)</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s">&#39;Colour Developers, Paul Centore&#39;</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s">&#39;Copyright (C) 2013 - 2015 - Colour Developers&#39;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s">&#39;New BSD License - http://opensource.org/licenses/BSD-3-Clause&#39;</span>
<span class="n">__maintainer__</span> <span class="o">=</span> <span class="s">&#39;Colour Developers&#39;</span>
<span class="n">__email__</span> <span class="o">=</span> <span class="s">&#39;colour-science@googlegroups.com&#39;</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s">&#39;Production&#39;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;MUNSELL_GRAY_PATTERN&#39;</span><span class="p">,</span>
           <span class="s">&#39;MUNSELL_COLOUR_PATTERN&#39;</span><span class="p">,</span>
           <span class="s">&#39;MUNSELL_GRAY_FORMAT&#39;</span><span class="p">,</span>
           <span class="s">&#39;MUNSELL_COLOUR_FORMAT&#39;</span><span class="p">,</span>
           <span class="s">&#39;MUNSELL_GRAY_EXTENDED_FORMAT&#39;</span><span class="p">,</span>
           <span class="s">&#39;MUNSELL_COLOUR_EXTENDED_FORMAT&#39;</span><span class="p">,</span>
           <span class="s">&#39;MUNSELL_HUE_LETTER_CODES&#39;</span><span class="p">,</span>
           <span class="s">&#39;MUNSELL_DEFAULT_ILLUMINANT&#39;</span><span class="p">,</span>
           <span class="s">&#39;MUNSELL_DEFAULT_ILLUMINANT_CHROMATICITY_COORDINATES&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_value_Priest1920&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_value_Munsell1933&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_value_Moon1943&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_value_Saunderson1944&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_value_Ladd1955&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_value_McCamy1987&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_value_ASTMD153508&#39;</span><span class="p">,</span>
           <span class="s">&#39;MUNSELL_VALUE_METHODS&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_value&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_specification_to_xyY&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_colour_to_xyY&#39;</span><span class="p">,</span>
           <span class="s">&#39;xyY_to_munsell_specification&#39;</span><span class="p">,</span>
           <span class="s">&#39;xyY_to_munsell_colour&#39;</span><span class="p">,</span>
           <span class="s">&#39;parse_munsell_colour&#39;</span><span class="p">,</span>
           <span class="s">&#39;is_grey_munsell_colour&#39;</span><span class="p">,</span>
           <span class="s">&#39;normalize_munsell_specification&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_colour_to_munsell_specification&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_specification_to_munsell_colour&#39;</span><span class="p">,</span>
           <span class="s">&#39;xyY_from_renotation&#39;</span><span class="p">,</span>
           <span class="s">&#39;is_specification_in_renotation&#39;</span><span class="p">,</span>
           <span class="s">&#39;bounding_hues_from_renotation&#39;</span><span class="p">,</span>
           <span class="s">&#39;hue_to_hue_angle&#39;</span><span class="p">,</span>
           <span class="s">&#39;hue_angle_to_hue&#39;</span><span class="p">,</span>
           <span class="s">&#39;hue_to_ASTM_hue&#39;</span><span class="p">,</span>
           <span class="s">&#39;interpolation_method_from_renotation_ovoid&#39;</span><span class="p">,</span>
           <span class="s">&#39;xy_from_renotation_ovoid&#39;</span><span class="p">,</span>
           <span class="s">&#39;LCHab_to_munsell_specification&#39;</span><span class="p">,</span>
           <span class="s">&#39;maximum_chroma_from_renotation&#39;</span><span class="p">,</span>
           <span class="s">&#39;munsell_specification_to_xy&#39;</span><span class="p">]</span>

<span class="n">MUNSELL_GRAY_PATTERN</span> <span class="o">=</span> <span class="s">&#39;N(?P&lt;value&gt;{0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">FLOATING_POINT_NUMBER_PATTERN</span><span class="p">)</span>
<span class="n">MUNSELL_COLOUR_PATTERN</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s">&#39;(?P&lt;hue&gt;{0})\s*&#39;</span>
    <span class="s">&#39;(?P&lt;letter&gt;BG|GY|YR|RP|PB|B|G|Y|R|P)\s*&#39;</span>
    <span class="s">&#39;(?P&lt;value&gt;{0})\s*\/\s*(?P&lt;chroma&gt;[-+]?{0})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">FLOATING_POINT_NUMBER_PATTERN</span><span class="p">))</span>

<span class="n">MUNSELL_GRAY_FORMAT</span> <span class="o">=</span> <span class="s">&#39;N{0}&#39;</span>
<span class="n">MUNSELL_COLOUR_FORMAT</span> <span class="o">=</span> <span class="s">&#39;{0} {1}/{2}&#39;</span>
<span class="n">MUNSELL_GRAY_EXTENDED_FORMAT</span> <span class="o">=</span> <span class="s">&#39;N{0:.{1}f}&#39;</span>
<span class="n">MUNSELL_COLOUR_EXTENDED_FORMAT</span> <span class="o">=</span> <span class="s">&#39;{0:.{1}f}{2} {3:.{4}f}/{5:.{6}f}&#39;</span>

<span class="n">MUNSELL_HUE_LETTER_CODES</span> <span class="o">=</span> <span class="n">Lookup</span><span class="p">({</span>
    <span class="s">&#39;BG&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s">&#39;GY&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s">&#39;YR&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s">&#39;RP&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">&#39;PB&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s">&#39;B&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&#39;G&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s">&#39;Y&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s">&#39;R&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s">&#39;P&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>

<span class="n">MUNSELL_DEFAULT_ILLUMINANT</span> <span class="o">=</span> <span class="s">&#39;C&#39;</span>
<span class="n">MUNSELL_DEFAULT_ILLUMINANT_CHROMATICITY_COORDINATES</span> <span class="o">=</span> <span class="n">ILLUMINANTS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s">&#39;CIE 1931 2 Degree Standard Observer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">MUNSELL_DEFAULT_ILLUMINANT</span><span class="p">)</span>

<span class="n">_MUNSELL_SPECIFICATIONS_CACHE</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">_MUNSELL_VALUE_ASTM_D1535_08_INTERPOLATOR_CACHE</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">_MUNSELL_MAXIMUM_CHROMAS_FROM_RENOTATION_CACHE</span> <span class="o">=</span> <span class="bp">None</span>


<span class="k">def</span> <span class="nf">_munsell_specifications</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell Renotation System* specifications and caches them if</span>
<span class="sd">    not existing.</span>

<span class="sd">    The *Munsell Renotation System* data is stored in</span>
<span class="sd">    :attr:`colour.notation.dataset.munsell.MUNSELL_COLOURS` attribute in a 2</span>
<span class="sd">    columns form:</span>

<span class="sd">    ((&#39;2.5GY&#39;, 0.2, 2.0), (0.713, 1.414, 0.237)),</span>
<span class="sd">    ((&#39;5GY&#39;, 0.2, 2.0), (0.449, 1.145, 0.237)),</span>
<span class="sd">    ((&#39;7.5GY&#39;, 0.2, 2.0), (0.262, 0.837, 0.237)),</span>
<span class="sd">    ...,)</span>

<span class="sd">    The first column is converted from *Munsell* colour to specification using</span>
<span class="sd">    :func:`munsell_colour_to_munsell_specification` definition:</span>

<span class="sd">    (&#39;2.5GY&#39;, 0.2, 2.0) ---&gt; (2.5, 0.2, 2.0, 4)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        *Munsell Renotation System* specifications.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">_MUNSELL_SPECIFICATIONS_CACHE</span>
    <span class="k">if</span> <span class="n">_MUNSELL_SPECIFICATIONS_CACHE</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">_MUNSELL_SPECIFICATIONS_CACHE</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">munsell_colour_to_munsell_specification</span><span class="p">(</span>
                <span class="n">MUNSELL_COLOUR_FORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">colour</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">for</span> <span class="n">colour</span> <span class="ow">in</span> <span class="n">MUNSELL_COLOURS_ALL</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">_MUNSELL_SPECIFICATIONS_CACHE</span>


<span class="k">def</span> <span class="nf">_munsell_value_ASTMD153508_interpolator</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell* value interpolator for ASTM D1535-08e1 (2008) method</span>
<span class="sd">    and caches it if not existing.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Extrapolator1d</span>
<span class="sd">        *Munsell* value interpolator for ASTM D1535-08e1 (2008) method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">_MUNSELL_VALUE_ASTM_D1535_08_INTERPOLATOR_CACHE</span>
    <span class="n">munsell_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_MUNSELL_VALUE_ASTM_D1535_08_INTERPOLATOR_CACHE</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">_MUNSELL_VALUE_ASTM_D1535_08_INTERPOLATOR_CACHE</span> <span class="o">=</span> <span class="n">Extrapolator1d</span><span class="p">(</span>
            <span class="n">LinearInterpolator1d</span><span class="p">(</span>
                <span class="n">luminance_ASTMD153508</span><span class="p">(</span><span class="n">munsell_values</span><span class="p">),</span>
                <span class="n">munsell_values</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">_MUNSELL_VALUE_ASTM_D1535_08_INTERPOLATOR_CACHE</span>


<span class="k">def</span> <span class="nf">_munsell_maximum_chromas_from_renotation</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the maximum *Munsell* chromas from *Munsell Renotation System* data</span>
<span class="sd">    and caches them if not existing.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        Maximum *Munsell* chromas.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">_MUNSELL_MAXIMUM_CHROMAS_FROM_RENOTATION_CACHE</span>
    <span class="k">if</span> <span class="n">_MUNSELL_MAXIMUM_CHROMAS_FROM_RENOTATION_CACHE</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">chromas</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">munsell_colour</span> <span class="ow">in</span> <span class="n">MUNSELL_COLOURS_ALL</span><span class="p">:</span>
            <span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">munsell_colour_to_munsell_specification</span><span class="p">(</span>
                <span class="n">MUNSELL_COLOUR_FORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">munsell_colour</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">chromas</span><span class="p">:</span>
                <span class="n">chroma</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">chromas</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">chroma</span><span class="p">)</span>

            <span class="n">chromas</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">chroma</span>

        <span class="n">_MUNSELL_MAXIMUM_CHROMAS_FROM_RENOTATION_CACHE</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="nb">zip</span><span class="p">(</span><span class="n">chromas</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">chromas</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">_MUNSELL_MAXIMUM_CHROMAS_FROM_RENOTATION_CACHE</span>


<div class="viewcode-block" id="munsell_value_Priest1920"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_value_Priest1920">[docs]</a><span class="k">def</span> <span class="nf">munsell_value_Priest1920</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell* value :math:`V` of given *luminance* :math:`Y` using</span>
<span class="sd">    *⁠⁠⁠⁠⁠Priest, Gibson and MacNicholas (1920)* method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Y : numeric or array_like</span>
<span class="sd">        *luminance* :math:`Y`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or ndarray</span>
<span class="sd">        *Munsell* value :math:`V`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Y* is in domain [0, 100].</span>
<span class="sd">    -   Output *V* is in domain [0, 10].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [3]  Wikipedia. (n.d.). Lightness. Retrieved April 13, 2014, from</span>
<span class="sd">            http://en.wikipedia.org/wiki/Lightness</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_value_Priest1920(10.08)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.1749015...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">V</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Y</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">V</span>

</div>
<div class="viewcode-block" id="munsell_value_Munsell1933"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_value_Munsell1933">[docs]</a><span class="k">def</span> <span class="nf">munsell_value_Munsell1933</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell* value :math:`V` of given *luminance* :math:`Y` using</span>
<span class="sd">    *⁠Munsell, Sloan and Godlove (1933)* method. [3]_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Y : numeric or array_like</span>
<span class="sd">        *luminance* :math:`Y`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or ndarray</span>
<span class="sd">        *Munsell* value :math:`V`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Y* is in domain [0, 100].</span>
<span class="sd">    -   Output *V* is in domain [0, 10].</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_value_Munsell1933(10.08)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.7918355...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.4742</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">-</span> <span class="mf">0.004743</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span> <span class="o">*</span> <span class="n">Y</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">V</span>

</div>
<div class="viewcode-block" id="munsell_value_Moon1943"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_value_Moon1943">[docs]</a><span class="k">def</span> <span class="nf">munsell_value_Moon1943</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell* value :math:`V` of given *luminance* :math:`Y` using</span>
<span class="sd">    Moon and Spencer (1943) method. [3]_</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Y : numeric or array_like</span>
<span class="sd">        *luminance* :math:`Y`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or ndarray</span>
<span class="sd">        *Munsell* value :math:`V`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Y* is in domain [0, 100].</span>
<span class="sd">    -   Output *V* is in domain [0, 10].</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_value_Moon1943(10.08)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.7462971...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">V</span> <span class="o">=</span> <span class="mf">1.4</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">**</span> <span class="mf">0.426</span>

    <span class="k">return</span> <span class="n">V</span>

</div>
<div class="viewcode-block" id="munsell_value_Saunderson1944"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_value_Saunderson1944">[docs]</a><span class="k">def</span> <span class="nf">munsell_value_Saunderson1944</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell* value :math:`V` of given *luminance* :math:`Y` using</span>
<span class="sd">    Saunderson and Milner (1944) method. [3]_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Y : numeric</span>
<span class="sd">        *luminance* :math:`Y`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric</span>
<span class="sd">        *Munsell* value :math:`V`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Y* is in domain [0, 100].</span>
<span class="sd">    -   Output *V* is in domain [0, 10].</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_value_Saunderson1944(10.08)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.6865080...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">V</span> <span class="o">=</span> <span class="mf">2.357</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span> <span class="o">**</span> <span class="mf">0.343</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.52</span>

    <span class="k">return</span> <span class="n">V</span>

</div>
<div class="viewcode-block" id="munsell_value_Ladd1955"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_value_Ladd1955">[docs]</a><span class="k">def</span> <span class="nf">munsell_value_Ladd1955</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell* value :math:`V` of given *luminance* :math:`Y` using</span>
<span class="sd">    Ladd and Pinney (1955)  method. [3]_</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Y : numeric or array_like</span>
<span class="sd">        *luminance* :math:`Y`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or ndarray</span>
<span class="sd">        *Munsell* value :math:`V`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Y* is in domain [0, 100].</span>
<span class="sd">    -   Output *V* is in domain [0, 10].</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_value_Ladd1955(10.08)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.6952862...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">V</span> <span class="o">=</span> <span class="mf">2.468</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.636</span>

    <span class="k">return</span> <span class="n">V</span>

</div>
<div class="viewcode-block" id="munsell_value_McCamy1987"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_value_McCamy1987">[docs]</a><span class="k">def</span> <span class="nf">munsell_value_McCamy1987</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell* value :math:`V` of given *luminance* :math:`Y` using</span>
<span class="sd">    McCamy (1987)  method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Y : numeric or array_like</span>
<span class="sd">        *luminance* :math:`Y`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or ndarray</span>
<span class="sd">        *Munsell* value :math:`V`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Y* is in domain [0, 100].</span>
<span class="sd">    -   Output *V* is in domain [0, 10].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [4]  ASTM International. (1989). ASTM D1535-89 Standard Test Method for</span>
<span class="sd">            Specifying Color by the Munsell System. Retrieved from</span>
<span class="sd">            http://www.astm.org/DATABASE.CART/HISTORICAL/D1535-89.htm</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_value_McCamy1987(10.08)  # doctest: +ELLIPSIS</span>
<span class="sd">    array(3.7347235...)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Y</span> <span class="o">&lt;=</span> <span class="mf">0.9</span><span class="p">,</span>
                 <span class="mf">0.87445</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span> <span class="o">**</span> <span class="mf">0.9967</span><span class="p">),</span>
                 <span class="p">(</span><span class="mf">2.49268</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span> <span class="o">-</span> <span class="mf">1.5614</span> <span class="o">-</span>
                  <span class="p">(</span><span class="mf">0.985</span> <span class="o">/</span> <span class="p">(((</span><span class="mf">0.1073</span> <span class="o">*</span> <span class="n">Y</span> <span class="o">-</span> <span class="mf">3.084</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">7.54</span><span class="p">))</span> <span class="o">+</span>
                  <span class="p">(</span><span class="mf">0.0133</span> <span class="o">/</span> <span class="p">(</span><span class="n">Y</span> <span class="o">**</span> <span class="mf">2.3</span><span class="p">))</span> <span class="o">+</span>
                  <span class="mf">0.0084</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">4.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span> <span class="o">**</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
                  <span class="p">(</span><span class="mf">0.0221</span> <span class="o">/</span> <span class="n">Y</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.39</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span> <span class="o">-</span>
                  <span class="p">(</span><span class="mf">0.0037</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.44</span> <span class="o">*</span> <span class="n">Y</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">1.28</span> <span class="o">*</span> <span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="mf">0.53</span><span class="p">))))</span>

    <span class="k">return</span> <span class="n">V</span>

</div>
<div class="viewcode-block" id="munsell_value_ASTMD153508"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_value_ASTMD153508">[docs]</a><span class="k">def</span> <span class="nf">munsell_value_ASTMD153508</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell* value :math:`V` of given *luminance* :math:`Y` using</span>
<span class="sd">    a reverse lookup table from ASTM D1535-08e1 (2008) method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Y : numeric or array_like</span>
<span class="sd">        *luminance* :math:`Y`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or ndarray</span>
<span class="sd">        *Munsell* value :math:`V`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Y* is in domain [0, 100].</span>
<span class="sd">    -   Output *V* is in domain [0, 10].</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_value_ASTMD153508(10.1488096782)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.7462971...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="n">V</span> <span class="o">=</span> <span class="n">_munsell_value_ASTMD153508_interpolator</span><span class="p">()(</span><span class="n">Y</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">V</span>

</div>
<span class="n">MUNSELL_VALUE_METHODS</span> <span class="o">=</span> <span class="n">CaseInsensitiveMapping</span><span class="p">(</span>
    <span class="p">{</span><span class="s">&#39;Priest 1920&#39;</span><span class="p">:</span> <span class="n">munsell_value_Priest1920</span><span class="p">,</span>
     <span class="s">&#39;Munsell 1933&#39;</span><span class="p">:</span> <span class="n">munsell_value_Munsell1933</span><span class="p">,</span>
     <span class="s">&#39;Moon 1943&#39;</span><span class="p">:</span> <span class="n">munsell_value_Moon1943</span><span class="p">,</span>
     <span class="s">&#39;Saunderson 1944&#39;</span><span class="p">:</span> <span class="n">munsell_value_Saunderson1944</span><span class="p">,</span>
     <span class="s">&#39;Ladd 1955&#39;</span><span class="p">:</span> <span class="n">munsell_value_Ladd1955</span><span class="p">,</span>
     <span class="s">&#39;McCamy 1987&#39;</span><span class="p">:</span> <span class="n">munsell_value_McCamy1987</span><span class="p">,</span>
     <span class="s">&#39;ASTM D1535-08&#39;</span><span class="p">:</span> <span class="n">munsell_value_ASTMD153508</span><span class="p">})</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Supported *Munsell* value computations methods.</span>

<span class="sd">MUNSELL_VALUE_METHODS : CaseInsensitiveMapping</span>
<span class="sd">    {&#39;Priest 1920&#39;, &#39;Munsell 1933&#39;, &#39;Moon 1943&#39;, &#39;Saunderson 1944&#39;,</span>
<span class="sd">    &#39;Ladd 1955&#39;, &#39;McCamy 1987&#39;, &#39;ASTM D1535-08&#39;}</span>

<span class="sd">Aliases:</span>

<span class="sd">-   &#39;astm2008&#39;: &#39;ASTM D1535-08&#39;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">MUNSELL_VALUE_METHODS</span><span class="p">[</span><span class="s">&#39;astm2008&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">MUNSELL_VALUE_METHODS</span><span class="p">[</span><span class="s">&#39;ASTM D1535-08&#39;</span><span class="p">])</span>


<div class="viewcode-block" id="munsell_value"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_value">[docs]</a><span class="k">def</span> <span class="nf">munsell_value</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;ASTM D1535-08&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the *Munsell* value :math:`V` of given *luminance* :math:`Y` using</span>
<span class="sd">    given method.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Y : numeric or array_like</span>
<span class="sd">        *luminance* :math:`Y`.</span>
<span class="sd">    method : unicode, optional</span>
<span class="sd">        {&#39;ASTM D1535-08&#39;, &#39;Priest 1920&#39;, &#39;Munsell 1933&#39;, &#39;Moon 1943&#39;,</span>
<span class="sd">        &#39;Saunderson 1944&#39;, &#39;Ladd 1955&#39;, &#39;McCamy 1987&#39;}</span>
<span class="sd">        Computation method.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or ndarray</span>
<span class="sd">        *Munsell* value :math:`V`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Y* is in domain [0, 100].</span>
<span class="sd">    -   Output *V* is in domain [0, 10].</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_value(10.08)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.7344764...</span>
<span class="sd">    &gt;&gt;&gt; munsell_value(10.08, method=&#39;Priest 1920&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.1749015...</span>
<span class="sd">    &gt;&gt;&gt; munsell_value(10.08, method=&#39;Munsell 1933&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.7918355...</span>
<span class="sd">    &gt;&gt;&gt; munsell_value(10.08, method=&#39;Moon 1943&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.7462971...</span>
<span class="sd">    &gt;&gt;&gt; munsell_value(10.08, method=&#39;Saunderson 1944&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.6865080...</span>
<span class="sd">    &gt;&gt;&gt; munsell_value(10.08, method=&#39;Ladd 1955&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    3.6952862...</span>
<span class="sd">    &gt;&gt;&gt; munsell_value(10.08, method=&#39;McCamy 1987&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    array(3.7347235...)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">MUNSELL_VALUE_METHODS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">method</span><span class="p">)(</span><span class="n">Y</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="munsell_specification_to_xyY"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_specification_to_xyY">[docs]</a><span class="k">def</span> <span class="nf">munsell_specification_to_xyY</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts given *Munsell* *Colorlab* specification to *CIE xyY* colourspace.</span>


<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    specification : numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ndarray, (3,)</span>
<span class="sd">        *CIE xyY* colourspace array.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Munsell* *Colorlab* specification hue must be in domain [0, 10].</span>
<span class="sd">    -   Input *Munsell* *Colorlab* specification value must be in domain</span>
<span class="sd">        [0, 10].</span>
<span class="sd">    -   Output *CIE xyY* colourspace array is in domain [0, 1].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [5]  Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellRenotationRoutines/MunsellToxyY.m. Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; spc = (2.1, 8.0, 17.9, 4)</span>
<span class="sd">    &gt;&gt;&gt; munsell_specification_to_xyY(spc)  # doctest: +ELLIPSIS</span>
<span class="sd">    array([ 0.4400632...,  0.5522428...,  0.5761962...])</span>
<span class="sd">    &gt;&gt;&gt; munsell_specification_to_xyY(8.9)  # doctest: +ELLIPSIS</span>
<span class="sd">    array([ 0.31006  ,  0.31616  ,  0.746134...])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">is_grey_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">specification</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">specification</span>

        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">hue</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification hue must be in domain [0, 10]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification value must be in domain [0, 10]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>

    <span class="n">Y</span> <span class="o">=</span> <span class="n">luminance_ASTMD153508</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">value_minus</span> <span class="o">=</span> <span class="n">value_plus</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">value_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">value_plus</span> <span class="o">=</span> <span class="n">value_minus</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">specification_minus</span> <span class="o">=</span> <span class="p">(</span><span class="n">value_minus</span>
                           <span class="k">if</span> <span class="n">is_grey_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">)</span> <span class="k">else</span>
                           <span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">value_minus</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span><span class="p">))</span>
    <span class="n">x_minus</span><span class="p">,</span> <span class="n">y_minus</span> <span class="o">=</span> <span class="n">munsell_specification_to_xy</span><span class="p">(</span><span class="n">specification_minus</span><span class="p">)</span>

    <span class="n">plus_specification</span> <span class="o">=</span> <span class="p">(</span><span class="n">value_plus</span>
                          <span class="k">if</span> <span class="p">(</span><span class="n">is_grey_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">)</span> <span class="ow">or</span>
                              <span class="n">value_plus</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="k">else</span>
                          <span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">value_plus</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span><span class="p">))</span>
    <span class="n">x_plus</span><span class="p">,</span> <span class="n">y_plus</span> <span class="o">=</span> <span class="n">munsell_specification_to_xy</span><span class="p">(</span><span class="n">plus_specification</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">value_minus</span> <span class="o">==</span> <span class="n">value_plus</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_minus</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y_minus</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Y_minus</span> <span class="o">=</span> <span class="n">luminance_ASTMD153508</span><span class="p">(</span><span class="n">value_minus</span><span class="p">)</span>
        <span class="n">Y_plus</span> <span class="o">=</span> <span class="n">luminance_ASTMD153508</span><span class="p">(</span><span class="n">value_plus</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">Y_minus</span><span class="p">,</span> <span class="n">Y_plus</span><span class="p">),</span> <span class="p">(</span><span class="n">x_minus</span><span class="p">,</span> <span class="n">x_plus</span><span class="p">))(</span><span class="n">Y</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">Y_minus</span><span class="p">,</span> <span class="n">Y_plus</span><span class="p">),</span> <span class="p">(</span><span class="n">y_minus</span><span class="p">,</span> <span class="n">y_plus</span><span class="p">))(</span><span class="n">Y</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Y</span> <span class="o">/</span> <span class="mi">100</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="munsell_colour_to_xyY"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_colour_to_xyY">[docs]</a><span class="k">def</span> <span class="nf">munsell_colour_to_xyY</span><span class="p">(</span><span class="n">munsell_colour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts given *Munsell* colour to *CIE xyY* colourspace.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    munsell_colour : unicode</span>
<span class="sd">        *Munsell* colour.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ndarray, (3,)</span>
<span class="sd">        *CIE xyY* colourspace array.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Output *CIE xyY* colourspace array is in domain [0, 1].</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_colour_to_xyY(&#39;4.2YR 8.1/5.3&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    array([ 0.3873694...,  0.3575165...,  0.59362   ])</span>
<span class="sd">    &gt;&gt;&gt; munsell_colour_to_xyY(&#39;N8.9&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    array([ 0.31006  ,  0.31616  ,  0.746134...])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">specification</span> <span class="o">=</span> <span class="n">munsell_colour_to_munsell_specification</span><span class="p">(</span><span class="n">munsell_colour</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">munsell_specification_to_xyY</span><span class="p">(</span><span class="n">specification</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="xyY_to_munsell_specification"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.xyY_to_munsell_specification">[docs]</a><span class="k">def</span> <span class="nf">xyY_to_munsell_specification</span><span class="p">(</span><span class="n">xyY</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts from *CIE xyY* colourspace to *Munsell* *Colorlab* specification.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xyY : array_like, (3,)</span>
<span class="sd">        *CIE xyY* colourspace array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the given *CIE xyY* colourspace array is not within MacAdam</span>
<span class="sd">        limits.</span>
<span class="sd">    RuntimeError</span>
<span class="sd">        If the maximum iterations count has been reached without converging to</span>
<span class="sd">        a result.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *CIE xyY* colourspace array is in domain [0, 1].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [6]  Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellRenotationRoutines/xyYtoMunsell.m. Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; xyY = np.array([0.38736945, 0.35751656, 0.59362000])</span>
<span class="sd">    &gt;&gt;&gt; xyY_to_munsell_specification(xyY)  # doctest: +ELLIPSIS</span>
<span class="sd">    (4.1742530..., 8.0999999..., 5.3044360..., 6)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_within_macadam_limits</span><span class="p">(</span><span class="n">xyY</span><span class="p">,</span> <span class="n">MUNSELL_DEFAULT_ILLUMINANT</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s">&#39;&quot;{0}&quot; is not within &quot;MacAdam&quot; limits for illuminant &#39;</span>
             <span class="s">&#39;&quot;{1}&quot;!&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xyY</span><span class="p">,</span> <span class="n">MUNSELL_DEFAULT_ILLUMINANT</span><span class="p">))</span>

    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">xyY</span><span class="p">)</span>

    <span class="c"># Scaling *Y* for algorithm needs.</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">munsell_value_ASTMD153508</span><span class="p">(</span><span class="n">Y</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="n">x_center</span><span class="p">,</span> <span class="n">y_center</span><span class="p">,</span> <span class="n">Y_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span>
        <span class="n">munsell_specification_to_xyY</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="n">z_input</span><span class="p">,</span> <span class="n">theta_input</span><span class="p">,</span> <span class="n">rho_input</span> <span class="o">=</span> <span class="n">cartesian_to_cylindrical</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_center</span><span class="p">,</span>
                                                                <span class="n">y</span> <span class="o">-</span> <span class="n">y_center</span><span class="p">,</span>
                                                                <span class="n">Y_center</span><span class="p">))</span>
    <span class="n">theta_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta_input</span><span class="p">)</span>

    <span class="n">grey_threshold</span> <span class="o">=</span> <span class="mf">0.001</span>
    <span class="k">if</span> <span class="n">rho_input</span> <span class="o">&lt;</span> <span class="n">grey_threshold</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">xyY_to_XYZ</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Y</span><span class="p">)))</span>
    <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span> <span class="o">=</span> <span class="n">MUNSELL_DEFAULT_ILLUMINANT_CHROMATICITY_COORDINATES</span>
    <span class="n">Xr</span><span class="p">,</span> <span class="n">Yr</span><span class="p">,</span> <span class="n">Zr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">xyY_to_XYZ</span><span class="p">((</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">Y</span><span class="p">)))</span>

    <span class="n">XYZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">])</span>
    <span class="n">XYZr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Yr</span><span class="p">)</span> <span class="o">*</span> <span class="n">Xr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Yr</span><span class="p">)</span> <span class="o">*</span> <span class="n">Zr</span><span class="p">])</span>

    <span class="n">Lab</span> <span class="o">=</span> <span class="n">XYZ_to_Lab</span><span class="p">(</span><span class="n">XYZ</span><span class="p">,</span> <span class="n">XYZ_to_xy</span><span class="p">(</span><span class="n">XYZr</span><span class="p">))</span>
    <span class="n">LCHab</span> <span class="o">=</span> <span class="n">Lab_to_LCHab</span><span class="p">(</span><span class="n">Lab</span><span class="p">)</span>
    <span class="n">hue_initial</span><span class="p">,</span> <span class="n">value_initial</span><span class="p">,</span> <span class="n">chroma_initial</span><span class="p">,</span> <span class="n">code_initial</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">LCHab_to_munsell_specification</span><span class="p">(</span><span class="n">LCHab</span><span class="p">))</span>
    <span class="n">specification_current</span> <span class="o">=</span> <span class="p">[</span><span class="n">hue_initial</span><span class="p">,</span>
                             <span class="n">value</span><span class="p">,</span>
                             <span class="p">(</span><span class="mi">5</span> <span class="o">/</span> <span class="mf">5.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">chroma_initial</span><span class="p">,</span>
                             <span class="n">code_initial</span><span class="p">]</span>

    <span class="n">convergence_threshold</span> <span class="o">=</span> <span class="mf">0.0001</span>
    <span class="n">iterations_maximum</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">iterations</span> <span class="o">&lt;=</span> <span class="n">iterations_maximum</span><span class="p">:</span>
        <span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">hue_current</span><span class="p">,</span> <span class="n">value_current</span><span class="p">,</span> <span class="n">chroma_current</span><span class="p">,</span> <span class="n">code_current</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">specification_current</span><span class="p">)</span>
        <span class="n">hue_angle_current</span> <span class="o">=</span> <span class="n">hue_to_hue_angle</span><span class="p">(</span><span class="n">hue_current</span><span class="p">,</span> <span class="n">code_current</span><span class="p">)</span>

        <span class="n">chroma_maximum</span> <span class="o">=</span> <span class="n">maximum_chroma_from_renotation</span><span class="p">(</span><span class="n">hue_current</span><span class="p">,</span>
                                                        <span class="n">value</span><span class="p">,</span>
                                                        <span class="n">code_current</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">chroma_current</span> <span class="o">&gt;</span> <span class="n">chroma_maximum</span><span class="p">:</span>
            <span class="n">chroma_current</span> <span class="o">=</span> <span class="n">specification_current</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">chroma_maximum</span>

        <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">Y_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span>
            <span class="n">munsell_specification_to_xyY</span><span class="p">(</span><span class="n">specification_current</span><span class="p">))</span>

        <span class="n">z_current</span><span class="p">,</span> <span class="n">theta_current</span><span class="p">,</span> <span class="n">rho_current</span> <span class="o">=</span> <span class="n">cartesian_to_cylindrical</span><span class="p">(</span>
            <span class="p">(</span><span class="n">x_current</span> <span class="o">-</span> <span class="n">x_center</span><span class="p">,</span>
             <span class="n">y_current</span> <span class="o">-</span> <span class="n">y_center</span><span class="p">,</span>
             <span class="n">Y_center</span><span class="p">))</span>
        <span class="n">theta_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta_current</span><span class="p">)</span>
        <span class="n">theta_current_difference</span> <span class="o">=</span> <span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="n">theta_input</span> <span class="o">+</span> <span class="n">theta_current</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="k">if</span> <span class="n">theta_current_difference</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
            <span class="n">theta_current_difference</span> <span class="o">-=</span> <span class="mi">360</span>

        <span class="n">theta_differences</span> <span class="o">=</span> <span class="p">[</span><span class="n">theta_current_difference</span><span class="p">]</span>
        <span class="n">hue_angles</span> <span class="o">=</span> <span class="p">[</span><span class="n">hue_angle_current</span><span class="p">]</span>
        <span class="n">hue_angles_differences</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">iterations_maximum_inner</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="n">iterations_inner</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">extrapolate</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">theta_differences</span><span class="p">))</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span>
                <span class="nb">max</span><span class="p">(</span><span class="n">theta_differences</span><span class="p">))</span> <span class="ow">and</span> <span class="n">extrapolate</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">iterations_inner</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">iterations_inner</span> <span class="o">&gt;</span> <span class="n">iterations_maximum_inner</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">((</span><span class="s">&#39;Maximum inner iterations count reached &#39;</span>
                                    <span class="s">&#39;without convergence!&#39;</span><span class="p">))</span>

            <span class="n">hue_angle_inner</span> <span class="o">=</span> <span class="p">((</span><span class="n">hue_angle_current</span> <span class="o">+</span> <span class="n">iterations_inner</span> <span class="o">*</span>
                                <span class="p">(</span><span class="n">theta_input</span> <span class="o">-</span> <span class="n">theta_current</span><span class="p">))</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span>
            <span class="n">hue_angle_difference_inner</span> <span class="o">=</span> <span class="p">(</span><span class="n">iterations_inner</span> <span class="o">*</span>
                                          <span class="p">(</span><span class="n">theta_input</span> <span class="o">-</span> <span class="n">theta_current</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">hue_angle_difference_inner</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                <span class="n">hue_angle_difference_inner</span> <span class="o">-=</span> <span class="mi">360</span>

            <span class="n">hue_inner</span><span class="p">,</span> <span class="n">code_inner</span> <span class="o">=</span> <span class="n">hue_angle_to_hue</span><span class="p">(</span><span class="n">hue_angle_inner</span><span class="p">)</span>
            <span class="n">x_inner</span><span class="p">,</span> <span class="n">y_inner</span><span class="p">,</span> <span class="n">Y_inner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span>
                <span class="n">munsell_specification_to_xyY</span><span class="p">((</span><span class="n">hue_inner</span><span class="p">,</span>
                                              <span class="n">value</span><span class="p">,</span>
                                              <span class="n">chroma_current</span><span class="p">,</span>
                                              <span class="n">code_inner</span><span class="p">)))</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta_differences</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">extrapolate</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="k">if</span> <span class="n">extrapolate</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">z_inner</span><span class="p">,</span> <span class="n">theta_inner</span><span class="p">,</span> <span class="n">rho_inner</span> <span class="o">=</span> <span class="n">cartesian_to_cylindrical</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">x_inner</span> <span class="o">-</span> <span class="n">x_center</span><span class="p">,</span>
                     <span class="n">y_inner</span> <span class="o">-</span> <span class="n">y_center</span><span class="p">,</span>
                     <span class="n">Y_center</span><span class="p">))</span>
                <span class="n">theta_inner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta_inner</span><span class="p">)</span>
                <span class="n">theta_inner_difference</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="n">theta_input</span> <span class="o">+</span> <span class="n">theta_inner</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">theta_inner_difference</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                    <span class="n">theta_inner_difference</span> <span class="o">-=</span> <span class="mi">360</span>

                <span class="n">theta_differences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta_inner_difference</span><span class="p">)</span>
                <span class="n">hue_angles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hue_angle_inner</span><span class="p">)</span>
                <span class="n">hue_angles_differences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hue_angle_difference_inner</span><span class="p">)</span>

        <span class="n">theta_differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta_differences</span><span class="p">)</span>
        <span class="n">hue_angles_differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hue_angles_differences</span><span class="p">)</span>

        <span class="n">theta_differences_indexes</span> <span class="o">=</span> <span class="n">theta_differences</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>

        <span class="n">theta_differences</span> <span class="o">=</span> <span class="n">theta_differences</span><span class="p">[</span><span class="n">theta_differences_indexes</span><span class="p">]</span>
        <span class="n">hue_angles_differences</span> <span class="o">=</span> <span class="n">hue_angles_differences</span><span class="p">[</span>
            <span class="n">theta_differences_indexes</span><span class="p">]</span>

        <span class="n">hue_angle_difference_new</span> <span class="o">=</span> <span class="n">Extrapolator1d</span><span class="p">(</span>
            <span class="n">LinearInterpolator1d</span><span class="p">(</span>
                <span class="n">theta_differences</span><span class="p">,</span>
                <span class="n">hue_angles_differences</span><span class="p">))(</span><span class="mi">0</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
        <span class="n">hue_angle_new</span> <span class="o">=</span> <span class="p">(</span><span class="n">hue_angle_current</span> <span class="o">+</span> <span class="n">hue_angle_difference_new</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>

        <span class="n">hue_new</span><span class="p">,</span> <span class="n">code_new</span> <span class="o">=</span> <span class="n">hue_angle_to_hue</span><span class="p">(</span><span class="n">hue_angle_new</span><span class="p">)</span>
        <span class="n">specification_current</span> <span class="o">=</span> <span class="p">[</span><span class="n">hue_new</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma_current</span><span class="p">,</span> <span class="n">code_new</span><span class="p">]</span>

        <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">Y_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span>
            <span class="n">munsell_specification_to_xyY</span><span class="p">(</span><span class="n">specification_current</span><span class="p">))</span>
        <span class="n">difference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">difference</span> <span class="o">&lt;</span> <span class="n">convergence_threshold</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">specification_current</span><span class="p">)</span>

        <span class="c"># TODO: Consider refactoring implementation.</span>
        <span class="n">hue_current</span><span class="p">,</span> <span class="n">value_current</span><span class="p">,</span> <span class="n">chroma_current</span><span class="p">,</span> <span class="n">code_current</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">specification_current</span><span class="p">)</span>
        <span class="n">chroma_maximum</span> <span class="o">=</span> <span class="n">maximum_chroma_from_renotation</span><span class="p">(</span><span class="n">hue_current</span><span class="p">,</span>
                                                        <span class="n">value</span><span class="p">,</span>
                                                        <span class="n">code_current</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">chroma_current</span> <span class="o">&gt;</span> <span class="n">chroma_maximum</span><span class="p">:</span>
            <span class="n">chroma_current</span> <span class="o">=</span> <span class="n">specification_current</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">chroma_maximum</span>

        <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">Y_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span>
            <span class="n">munsell_specification_to_xyY</span><span class="p">(</span><span class="n">specification_current</span><span class="p">))</span>

        <span class="n">z_current</span><span class="p">,</span> <span class="n">theta_current</span><span class="p">,</span> <span class="n">rho_current</span> <span class="o">=</span> <span class="n">cartesian_to_cylindrical</span><span class="p">(</span>
            <span class="p">(</span><span class="n">x_current</span> <span class="o">-</span> <span class="n">x_center</span><span class="p">,</span> <span class="n">y_current</span> <span class="o">-</span> <span class="n">y_center</span><span class="p">,</span> <span class="n">Y_center</span><span class="p">))</span>

        <span class="n">rho_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">rho_current</span><span class="p">]</span>
        <span class="n">chroma_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="n">chroma_current</span><span class="p">]</span>

        <span class="n">iterations_maximum_inner</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="n">iterations_inner</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">rho_input</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">rho_bounds</span><span class="p">)</span> <span class="ow">or</span> <span class="n">rho_input</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">rho_bounds</span><span class="p">):</span>
            <span class="n">iterations_inner</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">iterations_inner</span> <span class="o">&gt;</span> <span class="n">iterations_maximum_inner</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">((</span><span class="s">&#39;Maximum inner iterations count reached &#39;</span>
                                    <span class="s">&#39;without convergence!&#39;</span><span class="p">))</span>

            <span class="n">chroma_inner</span> <span class="o">=</span> <span class="p">(((</span><span class="n">rho_input</span> <span class="o">/</span> <span class="n">rho_current</span><span class="p">)</span> <span class="o">**</span> <span class="n">iterations_inner</span><span class="p">)</span> <span class="o">*</span>
                            <span class="n">chroma_current</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">chroma_inner</span> <span class="o">&gt;</span> <span class="n">chroma_maximum</span><span class="p">:</span>
                <span class="n">chroma_inner</span> <span class="o">=</span> <span class="n">specification_current</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">chroma_maximum</span>

            <span class="n">specification_inner</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">hue_current</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma_inner</span><span class="p">,</span> <span class="n">code_current</span><span class="p">)</span>
            <span class="n">x_inner</span><span class="p">,</span> <span class="n">y_inner</span><span class="p">,</span> <span class="n">Y_inner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span>
                <span class="n">munsell_specification_to_xyY</span><span class="p">(</span><span class="n">specification_inner</span><span class="p">))</span>

            <span class="n">z_inner</span><span class="p">,</span> <span class="n">theta_inner</span><span class="p">,</span> <span class="n">rho_inner</span> <span class="o">=</span> <span class="n">cartesian_to_cylindrical</span><span class="p">(</span>
                <span class="p">(</span><span class="n">x_inner</span> <span class="o">-</span> <span class="n">x_center</span><span class="p">,</span> <span class="n">y_inner</span> <span class="o">-</span> <span class="n">y_center</span><span class="p">,</span> <span class="n">Y_center</span><span class="p">))</span>

            <span class="n">rho_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho_inner</span><span class="p">)</span>
            <span class="n">chroma_bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chroma_inner</span><span class="p">)</span>

        <span class="n">rho_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rho_bounds</span><span class="p">)</span>
        <span class="n">chroma_bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">chroma_bounds</span><span class="p">)</span>

        <span class="n">rhos_bounds_indexes</span> <span class="o">=</span> <span class="n">rho_bounds</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>

        <span class="n">rho_bounds</span> <span class="o">=</span> <span class="n">rho_bounds</span><span class="p">[</span><span class="n">rhos_bounds_indexes</span><span class="p">]</span>
        <span class="n">chroma_bounds</span> <span class="o">=</span> <span class="n">chroma_bounds</span><span class="p">[</span><span class="n">rhos_bounds_indexes</span><span class="p">]</span>
        <span class="n">chroma_new</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">(</span><span class="n">rho_bounds</span><span class="p">,</span> <span class="n">chroma_bounds</span><span class="p">)(</span><span class="n">rho_input</span><span class="p">)</span>

        <span class="n">specification_current</span> <span class="o">=</span> <span class="p">[</span><span class="n">hue_current</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma_new</span><span class="p">,</span> <span class="n">code_current</span><span class="p">]</span>
        <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">Y_current</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span>
            <span class="n">munsell_specification_to_xyY</span><span class="p">(</span><span class="n">specification_current</span><span class="p">))</span>
        <span class="n">difference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">difference</span> <span class="o">&lt;</span> <span class="n">convergence_threshold</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">specification_current</span><span class="p">)</span>

    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
        <span class="s">&#39;Maximum outside iterations count reached without convergence!&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="xyY_to_munsell_colour"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.xyY_to_munsell_colour">[docs]</a><span class="k">def</span> <span class="nf">xyY_to_munsell_colour</span><span class="p">(</span><span class="n">xyY</span><span class="p">,</span>
                          <span class="n">hue_decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">value_decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                          <span class="n">chroma_decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts from *CIE xyY* colourspace to *Munsell* colour.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xyY : array_like, (3,)</span>
<span class="sd">        *CIE xyY* colourspace array.</span>
<span class="sd">    hue_decimals : int</span>
<span class="sd">        Hue formatting decimals.</span>
<span class="sd">    value_decimals : int</span>
<span class="sd">        Value formatting decimals.</span>
<span class="sd">    chroma_decimals : int</span>
<span class="sd">        Chroma formatting decimals.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    unicode</span>
<span class="sd">        *Munsell* colour.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *CIE xyY* colourspace array is in domain [0, 1].</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; xyY = np.array([0.38736945, 0.35751656, 0.59362000])</span>
<span class="sd">    &gt;&gt;&gt; # Doctests skip for Python 2.x compatibility.</span>
<span class="sd">    &gt;&gt;&gt; xyY_to_munsell_colour(xyY)  # doctest: +SKIP</span>
<span class="sd">    &#39;4.2YR 8.1/5.3&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">specification</span> <span class="o">=</span> <span class="n">xyY_to_munsell_specification</span><span class="p">(</span><span class="n">xyY</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">munsell_specification_to_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">,</span>
                                                   <span class="n">hue_decimals</span><span class="p">,</span>
                                                   <span class="n">value_decimals</span><span class="p">,</span>
                                                   <span class="n">chroma_decimals</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="parse_munsell_colour"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.parse_munsell_colour">[docs]</a><span class="k">def</span> <span class="nf">parse_munsell_colour</span><span class="p">(</span><span class="n">munsell_colour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses given *Munsell* colour and returns an intermediate *Munsell*</span>
<span class="sd">    *Colorlab* specification.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    munsell_colour : unicode</span>
<span class="sd">        *Munsell* colour.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float or tuple</span>
<span class="sd">        Intermediate *Munsell* *Colorlab* specification.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the given specification is not a valid *Munsell Renotation System*</span>
<span class="sd">        colour specification.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; parse_munsell_colour(&#39;N5.2&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    5.2...</span>
<span class="sd">    &gt;&gt;&gt; parse_munsell_colour(&#39;0YR 2.0/4.0&#39;)</span>
<span class="sd">    (0.0, 2.0, 4.0, 6)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">MUNSELL_GRAY_PATTERN</span><span class="p">,</span>
                     <span class="n">munsell_colour</span><span class="p">,</span>
                     <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;value&#39;</span><span class="p">))</span>
    <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">MUNSELL_COLOUR_PATTERN</span><span class="p">,</span>
                     <span class="n">munsell_colour</span><span class="p">,</span>
                     <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;hue&#39;</span><span class="p">)),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;value&#39;</span><span class="p">)),</span>
                <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;chroma&#39;</span><span class="p">)),</span>
                <span class="n">MUNSELL_HUE_LETTER_CODES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s">&#39;letter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="p">(</span><span class="s">&#39;&quot;{0}&quot; is not a valid &quot;Munsell Renotation System&quot; colour &#39;</span>
         <span class="s">&#39;specification!&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">munsell_colour</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="is_grey_munsell_colour"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.is_grey_munsell_colour">[docs]</a><span class="k">def</span> <span class="nf">is_grey_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns if given *Munsell* *Colorlab* specification is a single number form</span>
<span class="sd">    used for grey colour.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    specification : numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        Is specification a grey colour.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; is_grey_munsell_colour((0.0, 2.0, 4.0, 6))</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; is_grey_munsell_colour(0.5)</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">is_numeric</span><span class="p">(</span><span class="n">specification</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="normalize_munsell_specification"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.normalize_munsell_specification">[docs]</a><span class="k">def</span> <span class="nf">normalize_munsell_specification</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalises given *Munsell* *Colorlab* specification.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    specification : numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or tuple</span>
<span class="sd">        Normalised *Munsell* *Colorlab* specification.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; normalize_munsell_specification((0.0, 2.0, 4.0, 6))</span>
<span class="sd">    (10, 2.0, 4.0, 7)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">is_grey_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">specification</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">specification</span>
        <span class="k">if</span> <span class="n">hue</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># 0YR is equivalent to 10R.</span>
            <span class="n">hue</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">code</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>
        <span class="k">return</span> <span class="n">value</span> <span class="k">if</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="munsell_colour_to_munsell_specification"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_colour_to_munsell_specification">[docs]</a><span class="k">def</span> <span class="nf">munsell_colour_to_munsell_specification</span><span class="p">(</span><span class="n">munsell_colour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convenient definition to retrieve a normalised *Munsell* *Colorlab*</span>
<span class="sd">    specification from given *Munsell* colour.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    munsell_colour : unicode</span>
<span class="sd">        *Munsell* colour.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric or tuple</span>
<span class="sd">        Normalised *Munsell* *Colorlab* specification.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; munsell_colour_to_munsell_specification(&#39;N5.2&#39;)  # doctest: +ELLIPSIS</span>
<span class="sd">    5.2...</span>
<span class="sd">    &gt;&gt;&gt; munsell_colour_to_munsell_specification(&#39;0YR 2.0/4.0&#39;)</span>
<span class="sd">    (10, 2.0, 4.0, 7)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">normalize_munsell_specification</span><span class="p">(</span>
        <span class="n">parse_munsell_colour</span><span class="p">(</span><span class="n">munsell_colour</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="munsell_specification_to_munsell_colour"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_specification_to_munsell_colour">[docs]</a><span class="k">def</span> <span class="nf">munsell_specification_to_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">,</span>
                                            <span class="n">hue_decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                            <span class="n">value_decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                            <span class="n">chroma_decimals</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts from *Munsell* *Colorlab* specification to given *Munsell* colour.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    specification : numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>
<span class="sd">    hue_decimals : int, optional</span>
<span class="sd">        Hue formatting decimals.</span>
<span class="sd">    value_decimals : int, optional</span>
<span class="sd">        Value formatting decimals.</span>
<span class="sd">    chroma_decimals : int, optional</span>
<span class="sd">        Chroma formatting decimals.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    unicode</span>
<span class="sd">        *Munsell* colour.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; # Doctests skip for Python 2.x compatibility.</span>
<span class="sd">    &gt;&gt;&gt; munsell_specification_to_munsell_colour(5.2)  # doctest: +SKIP</span>
<span class="sd">    &#39;N5.2&#39;</span>
<span class="sd">    &gt;&gt;&gt; # Doctests skip for Python 2.x compatibility.</span>
<span class="sd">    &gt;&gt;&gt; spc = (10, 2.0, 4.0, 7)</span>
<span class="sd">    &gt;&gt;&gt; munsell_specification_to_munsell_colour(spc)  # doctest: +SKIP</span>
<span class="sd">    &#39;10.0R 2.0/4.0&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">is_grey_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MUNSELL_GRAY_EXTENDED_FORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">specification</span><span class="p">,</span> <span class="n">value_decimals</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">specification</span>
        <span class="n">code_values</span> <span class="o">=</span> <span class="n">MUNSELL_HUE_LETTER_CODES</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">hue</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification hue must be in domain [0, 10]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification value must be in domain [0, 10]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>
        <span class="k">assert</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">chroma</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification chroma must be in domain [2, 50]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">code_values</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification code must one of &quot;{1}&quot;!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">,</span> <span class="n">code_values</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">hue</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hue</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="n">code</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>

        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">MUNSELL_GRAY_EXTENDED_FORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">,</span> <span class="n">value_decimals</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hue_letter</span> <span class="o">=</span> <span class="n">MUNSELL_HUE_LETTER_CODES</span><span class="o">.</span><span class="n">first_key_from_value</span><span class="p">(</span>
                <span class="n">code</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">MUNSELL_COLOUR_EXTENDED_FORMAT</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span>
                                                         <span class="n">hue_decimals</span><span class="p">,</span>
                                                         <span class="n">hue_letter</span><span class="p">,</span>
                                                         <span class="n">value</span><span class="p">,</span>
                                                         <span class="n">value_decimals</span><span class="p">,</span>
                                                         <span class="n">chroma</span><span class="p">,</span>
                                                         <span class="n">chroma_decimals</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="xyY_from_renotation"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.xyY_from_renotation">[docs]</a><span class="k">def</span> <span class="nf">xyY_from_renotation</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns given existing *Munsell* *Colorlab* specification *CIE xyY*</span>
<span class="sd">    colourspace vector from *Munsell Renotation System* data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    specification : numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        *CIE xyY* colourspace vector.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the given specification doesn&#39;t exist in *Munsell Renotation System*</span>
<span class="sd">        data.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; xyY_from_renotation((2.5, 0.2, 2.0, 4))  # doctest: +ELLIPSIS</span>
<span class="sd">    (0.71..., 1.41..., 0.23...)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">specifications</span> <span class="o">=</span> <span class="n">_munsell_specifications</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">MUNSELL_COLOURS_ALL</span><span class="p">[</span><span class="n">specifications</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">specification</span><span class="p">)][</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="c"># TODO: Should raise KeyError, need to check the tests.</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s">&#39;&quot;{0}&quot; specification does not exists in &#39;</span>
             <span class="s">&#39;&quot;Munsell Renotation System&quot; data!&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">specification</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="is_specification_in_renotation"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.is_specification_in_renotation">[docs]</a><span class="k">def</span> <span class="nf">is_specification_in_renotation</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns if given *Munsell* *Colorlab* specification is in</span>
<span class="sd">    *Munsell Renotation System* data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    specification : numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        Is specification in *Munsell Renotation System* data.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; is_specification_in_renotation((2.5, 0.2, 2.0, 4))</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; is_specification_in_renotation((64, 0.2, 2.0, 4))</span>
<span class="sd">    False</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">xyY_from_renotation</span><span class="p">(</span><span class="n">specification</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="bounding_hues_from_renotation"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.bounding_hues_from_renotation">[docs]</a><span class="k">def</span> <span class="nf">bounding_hues_from_renotation</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns for a given hue the two bounding hues from</span>
<span class="sd">    *Munsell Renotation System* data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    hue : numeric</span>
<span class="sd">        *Munsell* *Colorlab* specification hue.</span>
<span class="sd">    code : numeric</span>
<span class="sd">        *Munsell* *Colorlab* specification code.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        Bounding hues.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [7]  Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellSystemRoutines/BoundingRenotationHues.m. Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; bounding_hues_from_renotation(3.2, 4)</span>
<span class="sd">    ((2.5, 4), (5.0, 4))</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">hue</span> <span class="o">%</span> <span class="mf">2.5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hue</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hue_cw</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">code_cw</span> <span class="o">=</span> <span class="p">(</span><span class="n">code</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hue_cw</span> <span class="o">=</span> <span class="n">hue</span>
            <span class="n">code_cw</span> <span class="o">=</span> <span class="n">code</span>
        <span class="n">hue_ccw</span> <span class="o">=</span> <span class="n">hue_cw</span>
        <span class="n">code_ccw</span> <span class="o">=</span> <span class="n">code_cw</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hue_cw</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">hue</span> <span class="o">/</span> <span class="mf">2.5</span><span class="p">)</span>
        <span class="n">hue_ccw</span> <span class="o">=</span> <span class="p">(</span><span class="n">hue_cw</span> <span class="o">+</span> <span class="mf">2.5</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="n">hue_ccw</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hue_ccw</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">code_ccw</span> <span class="o">=</span> <span class="n">code</span>

        <span class="k">if</span> <span class="n">hue_cw</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">hue_cw</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">code_cw</span> <span class="o">=</span> <span class="p">(</span><span class="n">code</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>
            <span class="k">if</span> <span class="n">code_cw</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">code_cw</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">code_cw</span> <span class="o">=</span> <span class="n">code</span>
        <span class="n">code_ccw</span> <span class="o">=</span> <span class="n">code</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">hue_cw</span><span class="p">,</span> <span class="n">code_cw</span><span class="p">),</span> <span class="p">(</span><span class="n">hue_ccw</span><span class="p">,</span> <span class="n">code_ccw</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="hue_to_hue_angle"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.hue_to_hue_angle">[docs]</a><span class="k">def</span> <span class="nf">hue_to_hue_angle</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts from the *Munsell* *Colorlab* specification hue to hue angle in</span>
<span class="sd">    degrees.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    hue : numeric</span>
<span class="sd">        *Munsell* *Colorlab* specification hue.</span>
<span class="sd">    code : numeric</span>
<span class="sd">        *Munsell* *Colorlab* specification code.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric</span>
<span class="sd">        Hue angle in degrees.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [8]  Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellRenotationRoutines/MunsellHueToChromDiagHueAngle.m.</span>
<span class="sd">            Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; hue_to_hue_angle(3.2, 4)</span>
<span class="sd">    65.5</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">single_hue</span> <span class="o">=</span> <span class="p">((</span><span class="mi">17</span> <span class="o">-</span> <span class="n">code</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">+</span> <span class="p">(</span><span class="n">hue</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>
    <span class="k">return</span> <span class="n">LinearInterpolator1d</span><span class="p">(</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">360</span><span class="p">))(</span><span class="n">single_hue</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="hue_angle_to_hue"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.hue_angle_to_hue">[docs]</a><span class="k">def</span> <span class="nf">hue_angle_to_hue</span><span class="p">(</span><span class="n">hue_angle</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts from hue angle in degrees to the *Munsell* *Colorlab*</span>
<span class="sd">    specification hue.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    hue_angle : numeric</span>
<span class="sd">        Hue angle in degrees.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        (*Munsell* *Colorlab* specification hue, *Munsell* *Colorlab*</span>
<span class="sd">        specification code).</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [9]  Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellRenotationRoutines/ChromDiagHueAngleToMunsellHue.m.</span>
<span class="sd">            Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; hue_angle_to_hue(65.54)  # doctest: +ELLIPSIS</span>
<span class="sd">    (3.2160000..., 4)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">single_hue</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">(</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">360</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">))(</span><span class="n">hue_angle</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="k">elif</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="k">elif</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">2.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">elif</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">3.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">4.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">elif</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">5.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">6.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">7.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="k">elif</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">8.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="k">elif</span> <span class="n">single_hue</span> <span class="o">&lt;=</span> <span class="mf">9.5</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">7</span>

    <span class="n">hue</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">single_hue</span> <span class="o">%</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>
    <span class="k">if</span> <span class="n">hue</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">hue</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="k">return</span> <span class="n">hue</span><span class="p">,</span> <span class="n">code</span>

</div>
<div class="viewcode-block" id="hue_to_ASTM_hue"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.hue_to_ASTM_hue">[docs]</a><span class="k">def</span> <span class="nf">hue_to_ASTM_hue</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts from the *Munsell* *Colorlab* specification hue to *ASTM* hue</span>
<span class="sd">    number in domain [0, 100].</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    hue : numeric</span>
<span class="sd">        *Munsell* *Colorlab* specification hue.</span>
<span class="sd">    code : numeric</span>
<span class="sd">        *Munsell* *Colorlab* specification code.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric</span>
<span class="sd">        *ASM* hue number.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [10] Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellRenotationRoutines/MunsellHueToASTMHue.m. Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; hue_to_ASTM_hue(3.2, 4)  # doctest: +ELLIPSIS</span>
<span class="sd">    33.2...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ASTM_hue</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">((</span><span class="mi">7</span> <span class="o">-</span> <span class="n">code</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">hue</span>
    <span class="k">return</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">ASTM_hue</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">ASTM_hue</span>

</div>
<div class="viewcode-block" id="interpolation_method_from_renotation_ovoid"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.interpolation_method_from_renotation_ovoid">[docs]</a><span class="k">def</span> <span class="nf">interpolation_method_from_renotation_ovoid</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns whether to use linear or radial interpolation when drawing ovoids</span>
<span class="sd">    through data points in the *Munsell Renotation System* data from given</span>
<span class="sd">    specification.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    specification : numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    unicode or None (&#39;Linear&#39;, &#39;Radial&#39;, None)</span>
<span class="sd">        Interpolation method.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Munsell* *Colorlab* specification value must be an integer in</span>
<span class="sd">        domain [0, 10].</span>
<span class="sd">    -   Input *Munsell* *Colorlab* specification chroma must be an integer and</span>
<span class="sd">        a multiple of 2 in domain [2, 50].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [11] Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellSystemRoutines/LinearVsRadialInterpOnRenotationOvoid.m.</span>
<span class="sd">            Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; spc = (2.5, 5.0, 12.0, 4)</span>
<span class="sd">    &gt;&gt;&gt; # Doctests skip for Python 2.x compatibility.</span>
<span class="sd">    &gt;&gt;&gt; interpolation_method_from_renotation_ovoid()  # doctest: +SKIP</span>
<span class="sd">    &#39;Radial&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">interpolation_methods</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
                             <span class="mi">1</span><span class="p">:</span> <span class="s">&#39;Linear&#39;</span><span class="p">,</span>
                             <span class="mi">2</span><span class="p">:</span> <span class="s">&#39;Radial&#39;</span><span class="p">}</span>
    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">is_grey_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
        <span class="c"># No interpolation needed for grey colours.</span>
        <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">specification</span>

        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification value must be in domain [0, 10]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification value must be an integer!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="c"># Ideal white, no interpolation needed.</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">assert</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">chroma</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification chroma must be in domain [2, 50]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">chroma</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">chroma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="n">INTEGER_THRESHOLD</span><span class="p">,</span> <span class="p">(</span>
            <span class="p">(</span><span class="s">&#39;&quot;{0}&quot; specification chroma must be an integer and &#39;</span>
             <span class="s">&#39;multiple of 2!&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">specification</span><span class="p">))</span>

        <span class="n">chroma</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">round</span><span class="p">(</span><span class="n">chroma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c"># Standard Munsell Renotation System hue, no interpolation needed.</span>
        <span class="k">if</span> <span class="n">hue</span> <span class="o">%</span> <span class="mf">2.5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">ASTM_hue</span> <span class="o">=</span> <span class="n">hue_to_ASTM_hue</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">15</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">or</span> <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">12.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">27.5</span> <span class="ow">or</span> <span class="mf">57.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">55</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">67.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">77.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">72.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">77.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">15</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">27.5</span> <span class="ow">or</span> <span class="mf">77.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">12.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">or</span> <span class="mf">62.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">7.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">22.5</span> <span class="ow">or</span> <span class="mf">62.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">7.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">15</span> <span class="ow">or</span> <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">65</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">77.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">10</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">37.5</span> <span class="ow">or</span> <span class="mi">65</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">37.5</span> <span class="ow">or</span> <span class="mi">55</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">72.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">7.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">37.5</span> <span class="ow">or</span> <span class="mf">57.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">82.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">&gt;=</span> <span class="mi">12</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">7.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mf">57.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">7.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mf">57.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">7.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="ow">or</span> <span class="mf">57.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">82.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">7.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="ow">or</span> <span class="mf">57.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">37.5</span> <span class="ow">or</span> <span class="mi">55</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">2.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mi">55</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">if</span> <span class="mf">2.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mi">55</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">82.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">37.5</span> <span class="ow">or</span> <span class="mi">55</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">87.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mf">57.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">87.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">12</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">14</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">82.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">&gt;=</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span> <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">82.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="mi">30</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span>
                                <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">25</span> <span class="ow">or</span>
                                <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">82.5</span><span class="p">):</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="mi">30</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span> <span class="ow">or</span>
                                <span class="mf">7.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">27.5</span> <span class="ow">or</span>
                                <span class="mi">80</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">82.5</span><span class="p">):</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">&gt;=</span> <span class="mi">14</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="mf">32.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="ow">or</span>
                                <span class="mf">7.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">15</span> <span class="ow">or</span>
                                <span class="mi">80</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">82.5</span><span class="p">):</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">chroma</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span>
                        <span class="n">chroma</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">or</span>
                        <span class="n">chroma</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">or</span>
                        <span class="n">chroma</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">or</span>
                        <span class="n">chroma</span> <span class="o">==</span> <span class="mi">10</span> <span class="ow">or</span>
                        <span class="n">chroma</span> <span class="o">==</span> <span class="mi">12</span><span class="p">):</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="ow">or</span> <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">&gt;=</span> <span class="mi">14</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="mf">32.5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="ow">or</span>
                                <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">15</span> <span class="ow">or</span>
                                <span class="mi">60</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">85</span><span class="p">):</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">chroma</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="ow">or</span> <span class="mi">55</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">chroma</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">or</span>
                          <span class="n">chroma</span> <span class="o">==</span> <span class="mi">8</span> <span class="ow">or</span>
                          <span class="n">chroma</span> <span class="o">==</span> <span class="mi">10</span> <span class="ow">or</span>
                          <span class="n">chroma</span> <span class="o">==</span> <span class="mi">12</span> <span class="ow">or</span>
                          <span class="n">chroma</span> <span class="o">==</span> <span class="mi">14</span><span class="p">):</span>
                <span class="k">if</span> <span class="mi">5</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">chroma</span> <span class="o">&gt;=</span> <span class="mi">16</span><span class="p">:</span>
                <span class="k">if</span> <span class="mi">35</span> <span class="o">&lt;</span> <span class="n">ASTM_hue</span> <span class="o">&lt;</span> <span class="mf">42.5</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">interpolation_method</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">interpolation_methods</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">interpolation_method</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="xy_from_renotation_ovoid"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.xy_from_renotation_ovoid">[docs]</a><span class="k">def</span> <span class="nf">xy_from_renotation_ovoid</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts given *Munsell* *Colorlab* specification to *xy* chromaticity</span>
<span class="sd">    coordinates on *Munsell Renotation System* ovoid.</span>
<span class="sd">    The *xy* point will be on the ovoid about the achromatic point,</span>
<span class="sd">    corresponding to the *Munsell* *Colorlab* specification</span>
<span class="sd">    value and chroma.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    specification : numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        *xy* chromaticity coordinates.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If an invalid interpolation method is retrieved from internal</span>
<span class="sd">        computations.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Munsell* *Colorlab* specification value must be an integer in</span>
<span class="sd">        domain [1, 9].</span>
<span class="sd">    -   Input *Munsell* *Colorlab* specification chroma must be an integer and</span>
<span class="sd">        a multiple of 2 in domain [2, 50].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [12] Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellRenotationRoutines/FindHueOnRenotationOvoid.m. Retrieved</span>
<span class="sd">            from https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; xy_from_renotation_ovoid((2.5, 5.0, 12.0, 4))  # doctest: +ELLIPSIS</span>
<span class="sd">    (0.4333..., 0.5602...)</span>
<span class="sd">    &gt;&gt;&gt; xy_from_renotation_ovoid(8)</span>
<span class="sd">    (0.31006, 0.31616)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">is_grey_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MUNSELL_DEFAULT_ILLUMINANT_CHROMATICITY_COORDINATES</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">specification</span>

        <span class="k">assert</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification value must be in domain [1, 9]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification value must be an integer!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">assert</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">chroma</span> <span class="o">&lt;=</span> <span class="mi">50</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification chroma must be in domain [2, 50]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">chroma</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">chroma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)))</span> <span class="o">&lt;=</span> <span class="n">INTEGER_THRESHOLD</span><span class="p">,</span> <span class="p">(</span>
            <span class="p">(</span><span class="s">&#39;&quot;{0}&quot; specification chroma must be an integer and &#39;</span>
             <span class="s">&#39;multiple of 2!&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">specification</span><span class="p">))</span>

        <span class="n">chroma</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">round</span><span class="p">(</span><span class="n">chroma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c"># Checking if renotation data is available without interpolation using</span>
        <span class="c"># given threshold.</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.001</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">hue</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span> <span class="ow">or</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">hue</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span> <span class="ow">or</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">hue</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span> <span class="ow">or</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">hue</span> <span class="o">-</span> <span class="mf">7.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span> <span class="ow">or</span>
                    <span class="nb">abs</span><span class="p">(</span><span class="n">hue</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">):</span>
            <span class="n">hue</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="nb">round</span><span class="p">(</span><span class="n">hue</span> <span class="o">/</span> <span class="mf">2.5</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">xyY_from_renotation</span><span class="p">((</span><span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

        <span class="n">hue_cw</span><span class="p">,</span> <span class="n">hue_ccw</span> <span class="o">=</span> <span class="n">bounding_hues_from_renotation</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
        <span class="n">hue_minus</span><span class="p">,</span> <span class="n">code_minus</span> <span class="o">=</span> <span class="n">hue_cw</span>
        <span class="n">hue_plus</span><span class="p">,</span> <span class="n">code_plus</span> <span class="o">=</span> <span class="n">hue_ccw</span>

        <span class="n">x_grey</span><span class="p">,</span> <span class="n">y_grey</span> <span class="o">=</span> <span class="n">MUNSELL_DEFAULT_ILLUMINANT_CHROMATICITY_COORDINATES</span>

        <span class="n">specification_minus</span> <span class="o">=</span> <span class="p">(</span><span class="n">hue_minus</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code_minus</span><span class="p">)</span>
        <span class="n">x_minus</span><span class="p">,</span> <span class="n">y_minus</span><span class="p">,</span> <span class="n">Y_minus</span> <span class="o">=</span> <span class="n">xyY_from_renotation</span><span class="p">(</span>
            <span class="n">specification_minus</span><span class="p">)</span>
        <span class="n">z_minus</span><span class="p">,</span> <span class="n">theta_minus</span><span class="p">,</span> <span class="n">rho_minus</span> <span class="o">=</span> <span class="n">cartesian_to_cylindrical</span><span class="p">(</span>
            <span class="p">(</span><span class="n">x_minus</span> <span class="o">-</span> <span class="n">x_grey</span><span class="p">,</span> <span class="n">y_minus</span> <span class="o">-</span> <span class="n">y_grey</span><span class="p">,</span> <span class="n">Y_minus</span><span class="p">))</span>
        <span class="n">theta_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta_minus</span><span class="p">)</span>

        <span class="n">specification_plus</span> <span class="o">=</span> <span class="p">(</span><span class="n">hue_plus</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code_plus</span><span class="p">)</span>
        <span class="n">x_plus</span><span class="p">,</span> <span class="n">y_plus</span><span class="p">,</span> <span class="n">Y_plus</span> <span class="o">=</span> <span class="n">xyY_from_renotation</span><span class="p">(</span><span class="n">specification_plus</span><span class="p">)</span>
        <span class="n">z_plus</span><span class="p">,</span> <span class="n">theta_plus</span><span class="p">,</span> <span class="n">rho_plus</span> <span class="o">=</span> <span class="n">cartesian_to_cylindrical</span><span class="p">(</span>
            <span class="p">(</span><span class="n">x_plus</span> <span class="o">-</span> <span class="n">x_grey</span><span class="p">,</span> <span class="n">y_plus</span> <span class="o">-</span> <span class="n">y_grey</span><span class="p">,</span> <span class="n">Y_plus</span><span class="p">))</span>
        <span class="n">theta_plus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">theta_plus</span><span class="p">)</span>

        <span class="n">lower_hue_angle</span> <span class="o">=</span> <span class="n">hue_to_hue_angle</span><span class="p">(</span><span class="n">hue_minus</span><span class="p">,</span> <span class="n">code_minus</span><span class="p">)</span>
        <span class="n">hue_angle</span> <span class="o">=</span> <span class="n">hue_to_hue_angle</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
        <span class="n">upper_hue_angle</span> <span class="o">=</span> <span class="n">hue_to_hue_angle</span><span class="p">(</span><span class="n">hue_plus</span><span class="p">,</span> <span class="n">code_plus</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">theta_minus</span> <span class="o">-</span> <span class="n">theta_plus</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
            <span class="n">theta_plus</span> <span class="o">+=</span> <span class="o">+</span><span class="mi">360</span>

        <span class="k">if</span> <span class="n">lower_hue_angle</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">lower_hue_angle</span> <span class="o">=</span> <span class="mi">360</span>

        <span class="k">if</span> <span class="n">lower_hue_angle</span> <span class="o">&gt;</span> <span class="n">upper_hue_angle</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lower_hue_angle</span> <span class="o">&gt;</span> <span class="n">hue_angle</span><span class="p">:</span>
                <span class="n">lower_hue_angle</span> <span class="o">-=</span> <span class="mi">360</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">lower_hue_angle</span> <span class="o">-=</span> <span class="mi">360</span>
                <span class="n">hue_angle</span> <span class="o">-=</span> <span class="mi">360</span>

        <span class="n">interpolation_method</span> <span class="o">=</span> <span class="n">interpolation_method_from_renotation_ovoid</span><span class="p">(</span>
            <span class="n">specification</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">interpolation_method</span> <span class="o">==</span> <span class="s">&#39;linear&#39;</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">lower_hue_angle</span><span class="p">,</span> <span class="n">upper_hue_angle</span><span class="p">),</span>
                                     <span class="p">(</span><span class="n">x_minus</span><span class="p">,</span> <span class="n">x_plus</span><span class="p">))(</span><span class="n">hue_angle</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">lower_hue_angle</span><span class="p">,</span> <span class="n">upper_hue_angle</span><span class="p">),</span>
                                     <span class="p">(</span><span class="n">y_minus</span><span class="p">,</span> <span class="n">y_plus</span><span class="p">))(</span><span class="n">hue_angle</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">interpolation_method</span> <span class="o">==</span> <span class="s">&#39;radial&#39;</span><span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">lower_hue_angle</span><span class="p">,</span> <span class="n">upper_hue_angle</span><span class="p">),</span>
                                         <span class="p">(</span><span class="n">theta_minus</span><span class="p">,</span> <span class="n">theta_plus</span><span class="p">))(</span><span class="n">hue_angle</span><span class="p">)</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">lower_hue_angle</span><span class="p">,</span> <span class="n">upper_hue_angle</span><span class="p">),</span>
                                       <span class="p">(</span><span class="n">rho_minus</span><span class="p">,</span> <span class="n">rho_plus</span><span class="p">))(</span><span class="n">hue_angle</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">x_grey</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">+</span> <span class="n">y_grey</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s">&#39;Invalid interpolation method: &quot;{0}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">interpolation_method</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

</div>
<div class="viewcode-block" id="LCHab_to_munsell_specification"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.LCHab_to_munsell_specification">[docs]</a><span class="k">def</span> <span class="nf">LCHab_to_munsell_specification</span><span class="p">(</span><span class="n">LCHab</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts from *CIE LCHab* colourspace to approximate *Munsell* *Colorlab*</span>
<span class="sd">    specification.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    LCHab : array_like, (3,)</span>
<span class="sd">        *CIE LCHab* colourspace array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input :math:`L^*` is in domain [0, 100].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [13] Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            GeneralRoutines/CIELABtoApproxMunsellSpec.m. Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; LCHab = np.array([100, 17.50664796, 244.93046842])</span>
<span class="sd">    &gt;&gt;&gt; LCHab_to_munsell_specification(LCHab)  # doctest: +ELLIPSIS</span>
<span class="sd">    (8.0362412..., 10.0, 3.5013295..., 1)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">L</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Hab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">LCHab</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">Hab</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="k">elif</span> <span class="n">Hab</span> <span class="o">&lt;=</span> <span class="mi">36</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="k">elif</span> <span class="n">Hab</span> <span class="o">&lt;=</span> <span class="mi">72</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="k">elif</span> <span class="n">Hab</span> <span class="o">&lt;=</span> <span class="mi">108</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">elif</span> <span class="n">Hab</span> <span class="o">&lt;=</span> <span class="mi">144</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">elif</span> <span class="n">Hab</span> <span class="o">&lt;=</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">elif</span> <span class="n">Hab</span> <span class="o">&lt;=</span> <span class="mi">216</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">elif</span> <span class="n">Hab</span> <span class="o">&lt;=</span> <span class="mi">252</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">Hab</span> <span class="o">&lt;=</span> <span class="mi">288</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="k">elif</span> <span class="n">Hab</span> <span class="o">&lt;=</span> <span class="mi">324</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">code</span> <span class="o">=</span> <span class="mi">8</span>

    <span class="n">hue</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">))(</span><span class="n">Hab</span> <span class="o">%</span> <span class="mi">36</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hue</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">hue</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">value</span> <span class="o">=</span> <span class="n">L</span> <span class="o">/</span> <span class="mi">10</span>
    <span class="n">chroma</span> <span class="o">=</span> <span class="n">C</span> <span class="o">/</span> <span class="mi">5</span>

    <span class="k">return</span> <span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span>

</div>
<div class="viewcode-block" id="maximum_chroma_from_renotation"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.maximum_chroma_from_renotation">[docs]</a><span class="k">def</span> <span class="nf">maximum_chroma_from_renotation</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the maximum *Munsell* chroma from *Munsell Renotation System* data</span>
<span class="sd">    using given *Munsell* *Colorlab* specification hue, *Munsell* *Colorlab*</span>
<span class="sd">    specification value and *Munsell* *Colorlab* specification code.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    hue : numeric</span>
<span class="sd">        *Munsell* *Colorlab* specification hue.</span>
<span class="sd">    value : numeric</span>
<span class="sd">        *Munsell* value code.</span>
<span class="sd">    code : numeric</span>
<span class="sd">        *Munsell* *Colorlab* specification code.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numeric</span>
<span class="sd">        Maximum chroma.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [14] Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellRenotationRoutines/MaxChromaForExtrapolatedRenotation.m.</span>
<span class="sd">            Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; maximum_chroma_from_renotation(2.5, 5, 5)</span>
<span class="sd">    14.0</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># Ideal white, no chroma.</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mf">9.99</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">assert</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span>
        <span class="s">&#39;&quot;{0}&quot; value must be in domain [1, 10]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">value</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">value_minus</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">value_plus</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">value_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">value_plus</span> <span class="o">=</span> <span class="n">value_minus</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">hue_cw</span><span class="p">,</span> <span class="n">hue_ccw</span> <span class="o">=</span> <span class="n">bounding_hues_from_renotation</span><span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
    <span class="n">hue_cw</span><span class="p">,</span> <span class="n">code_cw</span> <span class="o">=</span> <span class="n">hue_cw</span>
    <span class="n">hue_ccw</span><span class="p">,</span> <span class="n">code_ccw</span> <span class="o">=</span> <span class="n">hue_ccw</span>

    <span class="n">maximum_chromas</span> <span class="o">=</span> <span class="n">_munsell_maximum_chromas_from_renotation</span><span class="p">()</span>
    <span class="n">spc_for_indexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">chroma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">chroma</span> <span class="ow">in</span> <span class="n">maximum_chromas</span><span class="p">]</span>

    <span class="n">ma_limit_mcw</span> <span class="o">=</span> <span class="n">maximum_chromas</span><span class="p">[</span>
        <span class="n">spc_for_indexes</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">hue_cw</span><span class="p">,</span> <span class="n">value_minus</span><span class="p">,</span> <span class="n">code_cw</span><span class="p">))][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ma_limit_mccw</span> <span class="o">=</span> <span class="n">maximum_chromas</span><span class="p">[</span>
        <span class="n">spc_for_indexes</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">hue_ccw</span><span class="p">,</span> <span class="n">value_minus</span><span class="p">,</span> <span class="n">code_ccw</span><span class="p">))][</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">value_plus</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">:</span>
        <span class="n">ma_limit_pcw</span> <span class="o">=</span> <span class="n">maximum_chromas</span><span class="p">[</span>
            <span class="n">spc_for_indexes</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">hue_cw</span><span class="p">,</span> <span class="n">value_plus</span><span class="p">,</span> <span class="n">code_cw</span><span class="p">))][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ma_limit_pccw</span> <span class="o">=</span> <span class="n">maximum_chromas</span><span class="p">[</span>
            <span class="n">spc_for_indexes</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="n">hue_ccw</span><span class="p">,</span> <span class="n">value_plus</span><span class="p">,</span> <span class="n">code_ccw</span><span class="p">))][</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">max_chroma</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ma_limit_mcw</span><span class="p">,</span>
                         <span class="n">ma_limit_mccw</span><span class="p">,</span>
                         <span class="n">ma_limit_pcw</span><span class="p">,</span>
                         <span class="n">ma_limit_pccw</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">luminance_ASTMD153508</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">L9</span> <span class="o">=</span> <span class="n">luminance_ASTMD153508</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">L10</span> <span class="o">=</span> <span class="n">luminance_ASTMD153508</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">max_chroma</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">L9</span><span class="p">,</span> <span class="n">L10</span><span class="p">),</span> <span class="p">(</span><span class="n">ma_limit_mcw</span><span class="p">,</span> <span class="mi">0</span><span class="p">))(</span><span class="n">L</span><span class="p">),</span>
                         <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">L9</span><span class="p">,</span> <span class="n">L10</span><span class="p">),</span> <span class="p">(</span><span class="n">ma_limit_mccw</span><span class="p">,</span> <span class="mi">0</span><span class="p">))(</span>
                             <span class="n">L</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">max_chroma</span>

</div>
<div class="viewcode-block" id="munsell_specification_to_xy"><a class="viewcode-back" href="../../../colour.notation.munsell.html#colour.notation.munsell.munsell_specification_to_xy">[docs]</a><span class="k">def</span> <span class="nf">munsell_specification_to_xy</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts given *Munsell* *Colorlab* specification to *xy* chromaticity</span>
<span class="sd">    coordinates by interpolating over *Munsell Renotation System* data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    specification : numeric or tuple</span>
<span class="sd">        *Munsell* *Colorlab* specification.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    tuple</span>
<span class="sd">        *xy* chromaticity coordinates.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    -   Input *Munsell* *Colorlab* specification value must be an integer in</span>
<span class="sd">        domain [0, 10].</span>
<span class="sd">    -   Output *xy* chromaticity coordinates are in domain [0, 1].</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [15] Centore, P. (2014). MunsellAndKubelkaMunkToolboxApr2014 -</span>
<span class="sd">            MunsellRenotationRoutines/MunsellToxyForIntegerMunsellValue.m.</span>
<span class="sd">            Retrieved from</span>
<span class="sd">            https://github.com/colour-science/MunsellAndKubelkaMunkToolbox</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; # Doctests ellipsis for Python 2.x compatibility.</span>
<span class="sd">    &gt;&gt;&gt; munsell_specification_to_xy((2.1, 8.0, 17.9, 4))  # doctest: +ELLIPSIS</span>
<span class="sd">    (0.440063..., 0.552242...)</span>
<span class="sd">    &gt;&gt;&gt; munsell_specification_to_xy(8)  # doctest: +ELLIPSIS</span>
<span class="sd">    (0.31006..., 0.31616...)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">is_grey_munsell_colour</span><span class="p">(</span><span class="n">specification</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MUNSELL_DEFAULT_ILLUMINANT_CHROMATICITY_COORDINATES</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">code</span> <span class="o">=</span> <span class="n">specification</span>

        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification value must be in domain [0, 10]!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="p">(</span>
            <span class="s">&#39;&quot;{0}&quot; specification value must be an integer!&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">specification</span><span class="p">))</span>

        <span class="n">value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">chroma</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">chroma_minus</span> <span class="o">=</span> <span class="n">chroma_plus</span> <span class="o">=</span> <span class="n">chroma</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chroma_minus</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">chroma</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">chroma_plus</span> <span class="o">=</span> <span class="n">chroma_minus</span> <span class="o">+</span> <span class="mi">2</span>

        <span class="k">if</span> <span class="n">chroma_minus</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># Smallest chroma ovoid collapses to illuminant chromaticity</span>
            <span class="c"># coordinates.</span>
            <span class="n">x_minus</span><span class="p">,</span> <span class="n">y_minus</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">MUNSELL_DEFAULT_ILLUMINANT_CHROMATICITY_COORDINATES</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x_minus</span><span class="p">,</span> <span class="n">y_minus</span> <span class="o">=</span> <span class="n">xy_from_renotation_ovoid</span><span class="p">(</span>
                <span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma_minus</span><span class="p">,</span> <span class="n">code</span><span class="p">))</span>

        <span class="n">x_plus</span><span class="p">,</span> <span class="n">y_plus</span> <span class="o">=</span> <span class="n">xy_from_renotation_ovoid</span><span class="p">(</span>
            <span class="p">(</span><span class="n">hue</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">chroma_plus</span><span class="p">,</span> <span class="n">code</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">chroma_minus</span> <span class="o">==</span> <span class="n">chroma_plus</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x_minus</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y_minus</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">chroma_minus</span><span class="p">,</span> <span class="n">chroma_plus</span><span class="p">),</span>
                                     <span class="p">(</span><span class="n">x_minus</span><span class="p">,</span> <span class="n">x_plus</span><span class="p">))(</span><span class="n">chroma</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">LinearInterpolator1d</span><span class="p">((</span><span class="n">chroma_minus</span><span class="p">,</span> <span class="n">chroma_plus</span><span class="p">),</span>
                                     <span class="p">(</span><span class="n">y_minus</span><span class="p">,</span> <span class="n">y_plus</span><span class="p">))(</span><span class="n">chroma</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013 - 2015, Colour Developers.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>